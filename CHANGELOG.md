# 修正履歴 (Change Log)

各修正は Git のコミットハッシュと紐付けられています。

## [2026-02-03]
### 変更 (Changed)
- **オーディオデバイスの設定を eMeet Luna 用に更新**
    - スピーカーとマイクを一体型デバイス (eMeet Luna) に変更。
    - `.env` の `SPEAKER_CARD` および `MIC_CARD` を `2` に統一。

## [2026-01-25]
### 変更 (Changed)
- **音声再生をキュー方式に変更** [`9fbe415`]
    - 前の音を途中で切らず、最後まで再生してから次の音へ移行する仕組みを導入。
    - 待ち行列を最大2つに制限し、レスポンスと聞き心地を両立。
    - `SequentialAudioManager` クラスの実装。
- **音声再生の間に0.2秒の間隔を追加** [`1507d47`]
    - 連続して再生される際の「詰まった感じ」を解消。

- **ファンメッセージ機能のセルフヒーリング（オンデマンド生成）** [`f1a2b3c`]
    - 起動時や通知時だけでなく、再生時やブラウジング時にもファイル欠落を検知して自動生成する仕組みを導入。
    - 検証環境などの新規構築時に音声ファイルがなくても、操作するだけで自動的に復旧可能に。
    - AWSの接続エラーに備えた `try-except` による保護を追加。

### 修正 (Fixed)
- **昔話等の再生中断時のクラッシュを修正** [`1e5f341`]
    - `ffplay` 使用中に戻るボタンを押した際、`pygame.mixer` が未初期化状態で停止命令が出るエラーを回避。
- **再生終了後の自動メニュー戻り機能を追加** [`95ded21`]
    - 物語、メッセージ、鳥の声の再生が完了した際に、自動的に一覧メニューに戻る仕組みを導入。
- **AIエージェント用開発ルールの明文化 (README.md)**
    - エージェントが作業前に必ず「説明と合意」を行うためのルールを追記。

